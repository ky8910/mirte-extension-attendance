{"version":3,"file":"contentScript.js","mappings":";;;;;;AAAa;;AAEb;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,uCAAuC;AAC3D;;AAEA,sBAAsB,4BAA4B;AAClD;AACA;AACA;AACA;AACA;AACA,gGAAgG;AAChG,WAAW;;AAEX;AACA;;AAEA;;AAEA;;AAEA,0BAA0B,aAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wBAAwB,wBAAwB;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B,aAAa;AACvC;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC,E","sources":["webpack://mirte-extension/./src/contentScript.js"],"sourcesContent":["'use strict';\n\nconst absenceList = [\"廣川創太\", \"坪井恵\"];\n\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n\n  if (request.message == \"get YM\") {\n    let wndlct = window.location;\n    let url = wndlct.host + wndlct.port + wndlct.pathname;\n    if (url !== \"dev.mirte.jp/attendance/edit\" && url !== \"mirte.jp/attendance/edit\") {\n      sendResponse(\"no mirte\");\n    } else {\n      let YM = document.getElementsByName(\"txtYM\")[0].value;\n      sendResponse(YM);\n    }\n  } else if (request.message == \"sheet not found\") {\n    sendResponse(\"sheet not found\");\n  } else if (request.message == \"version failed\") {\n    sendResponse(\"version failed\");\n  } else {\n\n    let cannotFindOnMirteList = [];\n    let actuallyAbsenceList = [];\n    let StaffsOnMirteList = document.getElementsByClassName(\"table-responsive\")[0].children[1];\n    let excelDaySize;\n    let mirteDaySize;\n\n    //request.messageには、popup.jsから送信されたdatalist[]が送られてくる。\n    for (let i = 0; i < StaffsOnMirteList.children.length; i += 2) {\n      let noData = true;\n\n      for (let j = 0; j < request.message.length; j++) {\n        let staffData = StaffsOnMirteList.children[i].children;\n        if (request.message[j].name.replace(' ', '') == staffData[0].innerHTML.replace(' ', '')) {\n          excelDaySize = request.message[j].datas.length;\n          // データが入っている列のみ抽出して、名前と院名を除く\n          mirteDaySize = Array.prototype.slice.call(staffData).filter(function (value) {\n            return value.innerHTML != \"\" && value.innerHTML != \" \" && value.innerHTML != \"&nbsp;\"\n          }).length - 2;\n\n          // エクセル側かミルテ側のどちらか日数の小さい方まで取り込む\n          let daySize = Math.min(excelDaySize, mirteDaySize);\n\n          noData = false;\n\n          let dataList = request.message[j].datas;\n\n          for (let k = 0; k < daySize; k++) {\n            //〇＝出勤、✕＝休み\n            if (dataList[k] == \"〇\") {\n              staffData[k + 2].children[0].options[0].selected = true;\n            }\n            else if (dataList[k] == \"✕\") {\n              staffData[k + 2].children[0].options[1].selected = true;\n            }\n            else {\n              //暫定的に、〇、✕以外は”休”で反映させて対処している。\n              staffData[k + 2].children[0].options[1].selected = true;\n            }\n          }\n        }\n\n        // これ以降人物は一致しない\n        break;\n      }\n\n      if (noData) {\n        // エクセル側かミルテ側のどちらか日数の小さい方まで取り込む\n        let daySize = Math.min(excelDaySize, mirteDaySize);\n        let absence = false;\n\n        for (let l = 0; l < absenceList.length; l++) {\n          if (staffData[0].innerHTML.replace(' ', '') == absenceList[l].replace(' ', '')) {\n            absence = true;\n            break;\n          }\n        }\n\n        if (absence) {\n          for (let k = 0; k < daySize; k++) {\n            staffData[k + 2].children[0].options[1].selected = true;\n          }\n          actuallyAbsenceList.push(staffData[0].innerHTML.replace(' ', ''));\n        } else {\n          // 欠勤リストにない場合は反映していない表示を出す\n          cannotFindOnMirteList.push(StaffsOnMirteList.children[i].children[0].innerHTML);\n        }\n      }\n    }\n    sendResponse({\n      cannotFindOnMirteList,\n      actuallyAbsenceList,\n    });\n    return true;\n  }\n});"],"names":[],"sourceRoot":""}